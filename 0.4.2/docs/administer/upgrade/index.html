<!DOCTYPE html> <html lang="en-US"> <body> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="shortcut icon" href="/0.4.2/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/0.4.2/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/0.4.2/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/0.4.2/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Upgrade | Docs Firezone</title> <meta name="generator" content="Jekyll v3.9.2" /> <meta property="og:title" content="Upgrade" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="To upgrade Firezone, download the release package and run these commands. We recommend keeping your Firezone installation up-to-date." /> <meta property="og:description" content="To upgrade Firezone, download the release package and run these commands. We recommend keeping your Firezone installation up-to-date." /> <link rel="canonical" href="https://docs.firezone.dev/0.4.2/docs/administer/upgrade/" /> <meta property="og:url" content="https://docs.firezone.dev/0.4.2/docs/administer/upgrade/" /> <meta property="og:site_name" content="Docs Firezone" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Upgrade" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"To upgrade Firezone, download the release package and run these commands. We recommend keeping your Firezone installation up-to-date.","headline":"Upgrade","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://docs.firezone.dev/0.4.2/assets/images/logo-main.svg"}},"url":"https://docs.firezone.dev/0.4.2/docs/administer/upgrade/"}</script> <!-- End Jekyll SEO tag --> <script defer src="/assets/js/version-selector.js"></script> <!-- PostHog Telemetry --> <script> !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.async=!0,p.src=s.api_host+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]); posthog.init('phc_ubuPhiqqjMdedpmbWpG2Ak3axqv5eMVhFDNBaXl9UZK',{api_host:'https://telemetry.firez.one'}) </script> <!-- Fonts --> <link rel="preconnect" href="https://fonts.googleapis.com"> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:wght@300;400;500;600;700;900&display=swap" rel="stylesheet"> <link href="https://fonts.googleapis.com/css2?family=Fira+Mono&display=swap" rel="stylesheet"> <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500;600;700;900&display=swap" rel="stylesheet"> </head> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path> <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle> <line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line> <line x1="3" y1="6" x2="21" y2="6"></line> <line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path> <polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="https://docs.firezone.dev/0.4.2/" class="site-title lh-tight"> <div class="site-logo-wrapper"> <div class="site-logo"></div> <h1>Documentation</h1> </div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"> <use xlink:href="#svg-menu"></use> </svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <div class="select-version"> <label> Select version: <select class="version-selector"> </select> </label> </div> <ul class="nav-list"><li class="nav-list-item"><a href="https://docs.firezone.dev/0.4.2/" class="nav-list-link">Overview</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://docs.firezone.dev/0.4.2/docs/deploy/" class="nav-list-link">Deploy</a><ul class="nav-list "><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/deploy/supported-platforms/" class="nav-list-link">Supported Platforms</a></li><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/deploy/prerequisites/" class="nav-list-link">Prerequisites</a></li><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/deploy/server/" class="nav-list-link">Install Server</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://docs.firezone.dev/0.4.2/docs/authenticate/" class="nav-list-link">Authenticate</a><ul class="nav-list "><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/authenticate/google/" class="nav-list-link">Google</a></li><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/authenticate/okta/" class="nav-list-link">Okta</a></li><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/authenticate/azure-ad/" class="nav-list-link">Azure Active Directory</a></li><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/authenticate/web-auth/" class="nav-list-link">Local Email / Password Authentication</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://docs.firezone.dev/0.4.2/docs/administer/" class="nav-list-link">Administer</a><ul class="nav-list "><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/administer/configure/" class="nav-list-link">Configure</a></li><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/administer/manage/" class="nav-list-link">Manage Installation</a></li><li class="nav-list-item active"><a href="https://docs.firezone.dev/0.4.2/docs/administer/upgrade/" class="nav-list-link active">Upgrade</a></li><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/administer/uninstall/" class="nav-list-link">Uninstall</a></li><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/administer/troubleshoot/" class="nav-list-link">Troubleshoot</a></li><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/administer/security-considerations/" class="nav-list-link">Security Considerations</a></li><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/administer/running-sql-queries/" class="nav-list-link">Running SQL Queries</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://docs.firezone.dev/0.4.2/docs/user-guides/" class="nav-list-link">User Guides</a><ul class="nav-list "><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/user-guides/add-users/" class="nav-list-link">Add Users</a></li><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/user-guides/add-devices/" class="nav-list-link">Add Devices</a></li><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/user-guides/firewall-rules/" class="nav-list-link">Firewall Rules</a></li><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/user-guides/client-instructions/" class="nav-list-link">Client Instructions</a></li><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/user-guides/split-tunnel/" class="nav-list-link">Split Tunnel</a></li><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/user-guides/whitelist-vpn/" class="nav-list-link">Using Firezone as a NAT Gateway</a></li><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/user-guides/reverse-tunnel/" class="nav-list-link">Reverse Tunnel</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="https://docs.firezone.dev/0.4.2/docs/reference/" class="nav-list-link">Reference</a><ul class="nav-list "><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/reference/configuration-file/" class="nav-list-link">Configuration File</a></li><li class="nav-list-item "><a href="https://docs.firezone.dev/0.4.2/docs/reference/file-and-directory-locations/" class="nav-list-link">File and Directory Locations</a></li></ul></li></ul> </nav> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Docs | Firezone" aria-label="Search Docs | Firezone" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"> <use xlink:href="#svg-search"></use> </svg></label> </div> <div id="search-results" class="search-results"></div> </div> <nav aria-label="Auxiliary" class="aux-nav"> <ul class="aux-nav-list"> <li class="aux-nav-list-item"> <a href="https://discourse.firez.one" class="site-button" > Ask a Question </a> </li> <li class="aux-nav-list-item"> <a href="https://e04kusl9oz5.typeform.com/to/ZPYb31sA#int=docs&source=nav" class="site-button" > Join the Business Beta </a> </li> </ul> </nav> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="https://docs.firezone.dev/0.4.2/docs/administer/">Administer</a></li> <li class="breadcrumb-nav-list-item"><span>Upgrade</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1>Upgrade</h1> <hr /> <p>Upgrading Firezone will disconnect all VPN sessions and require shutting down the Web UI. We recommend a maintenance window of about an hour in case anything goes wrong during the upgrade.</p> <p>To upgrade Firezone, follow these steps:</p> <ol> <li>Download the new release for your platform.</li> <li>Install the new package over the old one: <code class="language-plaintext highlighter-rouge">sudo dpkg -i firezone_X.X.X.deb</code> or <code class="language-plaintext highlighter-rouge">sudo rpm -i --force firezone_X.X.X.rpm</code> depending on your distribution.</li> <li>Run <code class="language-plaintext highlighter-rouge">firezone-ctl reconfigure</code> to pick up the new changes.</li> <li>Run <code class="language-plaintext highlighter-rouge">firezone-ctl restart</code> to restart services.</li> </ol> <p>Occasionally problems arise. If you hit any, please let us know by <a href="https://github.com/firezone/firezone/issues/new/choose">filing an issue</a>.</p> <h2 id="upgrading-from-03x-to--0316"> <a href="#upgrading-from-03x-to--0316" class="anchor-heading" aria-labelledby="upgrading-from-03x-to--0316"><svg viewBox="0 0 16 16" aria-hidden="true"> <use xlink:href="#svg-link"></use> </svg></a> Upgrading from 0.3.x to &gt;= 0.3.16 </h2> <p>Follow the instructions below based on your current version and setup:</p> <h3 id="i-have-an-existing-oidc-integration"> <a href="#i-have-an-existing-oidc-integration" class="anchor-heading" aria-labelledby="i-have-an-existing-oidc-integration"><svg viewBox="0 0 16 16" aria-hidden="true"> <use xlink:href="#svg-link"></use> </svg></a> I have an existing OIDC integration </h3> <p>Upgrading to &gt;= 0.3.16 requires the <code class="language-plaintext highlighter-rouge">offline_access</code> scope for some OIDC providers to obtain a refresh token. This ensures Firezone syncs with the identity provider and VPN access is terminated once the user is removed. Previous versions of Firezone do not have this capability. Users who are removed from your identity provider will still have active VPN sessions in some cases.</p> <p>For OIDC providers that support the <code class="language-plaintext highlighter-rouge">offline_access</code> scope, you will need to add <code class="language-plaintext highlighter-rouge">offline_access</code> to the <code class="language-plaintext highlighter-rouge">scope</code> parameter of your OIDC config. The Firezone configuration file can be found at <code class="language-plaintext highlighter-rouge">/etc/firezone/firezone.rb</code> and requires running <code class="language-plaintext highlighter-rouge">firezone-ctl reconfigure</code> to pick up the changes.</p> <p>If Firezone is able to successfully retrieve the refresh token, you will see the <strong>OIDC Connections</strong> heading in the user details page of the web UI for users authenticated through your OIDC provider.</p> <p><img src="https://user-images.githubusercontent.com/52545545/173169922-b0e5f2f1-74d5-4313-b839-6a001041c07e.png" alt="OIDC Connections" /></p> <p>If this does not work, you will need to delete your existing OAuth app and repeat the OIDC setup steps to <a href="/docs/authenticate/">create a new app integration</a>.</p> <h3 id="i-have-an-existing-oauth-integration"> <a href="#i-have-an-existing-oauth-integration" class="anchor-heading" aria-labelledby="i-have-an-existing-oauth-integration"><svg viewBox="0 0 16 16" aria-hidden="true"> <use xlink:href="#svg-link"></use> </svg></a> I have an existing OAuth integration </h3> <p>Prior to 0.3.11, Firezone used pre-configured OAuth2 providers. Follow the instructions <a href="/docs/authenticate/">here</a> to migrate to OIDC.</p> <h3 id="i-have-not-integrated-an-identity-provider"> <a href="#i-have-not-integrated-an-identity-provider" class="anchor-heading" aria-labelledby="i-have-not-integrated-an-identity-provider"><svg viewBox="0 0 16 16" aria-hidden="true"> <use xlink:href="#svg-link"></use> </svg></a> I have not integrated an identity provider </h3> <p>No action needed. You can follow the instructions <a href="/docs/authenticate/">here</a> to enable SSO through an OIDC provider.</p> <h2 id="upgrading-from-031-to--032"> <a href="#upgrading-from-031-to--032" class="anchor-heading" aria-labelledby="upgrading-from-031-to--032"><svg viewBox="0 0 16 16" aria-hidden="true"> <use xlink:href="#svg-link"></use> </svg></a> Upgrading from 0.3.1 to &gt;= 0.3.2 </h2> <p>The configuration option <code class="language-plaintext highlighter-rouge">default['firezone']['fqdn']</code> has been removed in favor of <code class="language-plaintext highlighter-rouge">default['firezone']['external_url']</code>. Please set this to the publicly-accessible URL of your Firezone web portal. If left unspecified it will default to <code class="language-plaintext highlighter-rouge">https://</code> + the FQDN of your server.</p> <p>Reminder, the configuration file can be found at <code class="language-plaintext highlighter-rouge">/etc/firezone/firezone.rb</code>. For an exhaustive list of configuration variables and their descriptions, see the <a href="/docs/reference/configuration-file/">configuration file reference</a>.</p> <h2 id="upgrading-from-02x-to-03x"> <a href="#upgrading-from-02x-to-03x" class="anchor-heading" aria-labelledby="upgrading-from-02x-to-03x"><svg viewBox="0 0 16 16" aria-hidden="true"> <use xlink:href="#svg-link"></use> </svg></a> Upgrading from 0.2.x to 0.3.x </h2> <p><strong>Note</strong>: Starting with version 0.3.0, Firezone no longer stores device private keys on the Firezone server. Any existing devices should continue to function as-is, but you will not be able to re-download or view these configurations in the Firezone Web UI.</p> <h2 id="upgrading-from-01x-to-02x"> <a href="#upgrading-from-01x-to-02x" class="anchor-heading" aria-labelledby="upgrading-from-01x-to-02x"><svg viewBox="0 0 16 16" aria-hidden="true"> <use xlink:href="#svg-link"></use> </svg></a> Upgrading from 0.1.x to 0.2.x </h2> <p>Firezone 0.2.x contains some configuration file changes that will need to be handled manually if you’re upgrading from 0.1.x. Run the commands below as root to perform the needed changes to your <code class="language-plaintext highlighter-rouge">/etc/firezone/firezone.rb</code> file.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cp</span> /etc/firezone/firezone.rb /etc/firezone/firezone.rb.bak
<span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s/</span><span class="se">\[</span><span class="s2">'enable'</span><span class="se">\]</span><span class="s2">/</span><span class="se">\[</span><span class="s2">'enabled'</span><span class="se">\]</span><span class="s2">/"</span> /etc/firezone/firezone.rb
<span class="nb">echo</span> <span class="s2">"default['firezone']['connectivity_checks']['enabled'] = true"</span> <span class="o">&gt;&gt;</span> /etc/firezone/firezone.rb
<span class="nb">echo</span> <span class="s2">"default['firezone']['connectivity_checks']['interval'] = 3_600"</span> <span class="o">&gt;&gt;</span> /etc/firezone/firezone.rb
firezone-ctl reconfigure
firezone-ctl restart
</code></pre></div></div> <hr> <footer> <div class="mb-0"> <p> WireGuard® is a registered trademark of Jason A. Donenfeld. </p> <p> For support, first visit our <a href="https://discourse.firez.one/">Discussion Forums</a> </p> <a href="https://www.firezone.dev/">Company</a> | <a href="https://github.com/firezone/">Github</a> | <a href="https://twitter.com/firezonehq/">Twitter</a> </div> <div class="d-flex mt-2"> <p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/firezone/firezone/tree/master/docs/docs/administer/upgrade.md" id="edit-this-page">Edit on GitHub</a> </p> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
